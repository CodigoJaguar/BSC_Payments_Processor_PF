"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.signToken = exports.sign = void 0;
// std
const crypto_1 = require("crypto");
// FoalTS
const encoding_1 = require("../encoding");
function sign(base64Value, base64Secret) {
    return (0, crypto_1.createHmac)('sha256', Buffer.from(base64Secret, 'base64'))
        .update(Buffer.from(base64Value, 'base64'))
        .digest();
}
exports.sign = sign;
function signToken(unsignedToken, secret) {
    const signature = sign(unsignedToken, secret).toString('base64');
    return `${unsignedToken}.${(0, encoding_1.convertBase64ToBase64url)(signature)}`;
}
exports.signToken = signToken;
