"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.rmdir = void 0;
// std
const fs_1 = require("fs");
const path_1 = require("path");
const util_1 = require("util");
/**
 * Remove a directory and all its contents, including any subdirectories and files.
 *
 * @export
 * @param {string} path - The path of the directory
 * @returns {Promise<void>}
 */
async function rmdir(path) {
    let contents;
    try {
        contents = await (0, util_1.promisify)(fs_1.readdir)(path);
    }
    catch (error) {
        if (error.code === 'ENOENT') {
            return;
        }
        throw error;
    }
    await Promise.all(contents.map(content => {
        const subPath = (0, path_1.join)(path, content);
        return (0, util_1.promisify)(fs_1.stat)(subPath)
            .then(stats => {
            if (stats.isDirectory()) {
                return rmdir(subPath);
            }
            return (0, util_1.promisify)(fs_1.unlink)(subPath);
        });
    }));
    await (0, util_1.promisify)(fs_1.rmdir)(path);
}
exports.rmdir = rmdir;
